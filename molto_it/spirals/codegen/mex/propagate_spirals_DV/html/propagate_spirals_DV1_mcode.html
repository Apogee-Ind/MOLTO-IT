<html>
<body>
<script src="resources/eml_report_loadable_data.js"></script>
<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1" id="srcline1">  1</a></span><span class="line"><span class="keyword">function</span> [ <span class="var type1" id="S2T1U3">r</span> , <span class="var type1" id="S3T1U4">v</span> , <span class="var type0" id="S4T0U5">t</span> , <span class="var type1" id="S5T1U6">a</span> , <span class="var type1" id="S6T1U7">e</span> , <span class="var type1" id="S7T1U8">w</span> , <span class="var type1" id="S8T2U9">at</span> , <span class="var type1" id="S9T1U10">psi</span> ,<span class="var type1" id="S10T3U11">DV</span>, <span class="var type1" id="S11T3U12">flag</span>] = propagate_spirals_DV ( <span class="var type1" id="S12T3U15">K1</span>, <span class="var type1" id="S13T3U16">K2</span>, <span class="var type1" id="S14T3U17">ee</span>, <span class="var type1" id="S15T3U18">regime0</span>, <span class="var type1" id="S16T3U19">r0</span>, <span class="var type1" id="S17T3U20">theta0</span>, <span class="var type1" id="S18T3U21">t0</span>,  <span class="var type1" id="S19T1U22">theta</span> )</span></span>
<span class="srcline"><span class="lineno"><a href="1,2" id="srcline2">  2</a></span><span class="line"><span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,3" id="srcline3">  3</a></span><span class="line"><span class="comment">%              CONTROLLED GENERALIZED LOGARITHMIC SPIRALS</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,4" id="srcline4">  4</a></span><span class="line"><span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,5" id="srcline5">  5</a></span><span class="line"><span class="comment">% Function that computes the state vector [r(position), v(velocity), t(time)]</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,6" id="srcline6">  6</a></span><span class="line"><span class="comment">% and the classical orbital elements at specific angular positions for a </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,7" id="srcline7">  7</a></span><span class="line"><span class="comment">% given spiral defined by its control parameters K1, K2, and ee, given a </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,8" id="srcline8">  8</a></span><span class="line"><span class="comment">% initial position (r0,theta0)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,9" id="srcline9">  9</a></span><span class="line"><span class="comment">% INPUTS ::</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,10" id="srcline10"> 10</a></span><span class="line"><span class="comment">%        K2     :: Second control parameter</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,11" id="srcline11"> 11</a></span><span class="line"><span class="comment">%        K1     :: First control parameter</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,12" id="srcline12"> 12</a></span><span class="line"><span class="comment">%        r0     :: Initial Distance</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,13" id="srcline13"> 13</a></span><span class="line"><span class="comment">%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,14" id="srcline14"> 14</a></span><span class="line"><span class="comment">%        theta0 :: Initial orientation angle</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,15" id="srcline15"> 15</a></span><span class="line"><span class="comment">%        t0     :: Initial flight time</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,16" id="srcline16"> 16</a></span><span class="line"><span class="comment">%        ee     :: Third Control parameter</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,17" id="srcline17"> 17</a></span><span class="line"><span class="comment">%        regime0:: Initial spiral regime (raising[+1],lowering[-1])</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,18" id="srcline18"> 18</a></span><span class="line"><span class="comment">%        theta  :: Orientations at which the state is to be computed (scalar or vector)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,19" id="srcline19"> 19</a></span><span class="line"><span class="comment">% OUTPUTS ::</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,20" id="srcline20"> 20</a></span><span class="line"><span class="comment">%        r      :: Distance at theta</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,21" id="srcline21"> 21</a></span><span class="line"><span class="comment">%        v      :: velocity at theta</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,22" id="srcline22"> 22</a></span><span class="line"><span class="comment">%        t      :: time at theta</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,23" id="srcline23"> 23</a></span><span class="line"><span class="comment">%        a      :: semimajor axis      (OPTIONAL)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,24" id="srcline24"> 24</a></span><span class="line"><span class="comment">%        e      :: eccentricity        (OPTIONAL)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,25" id="srcline25"> 25</a></span><span class="line"><span class="comment">%        w      :: argument of perigee (OPTIONAL)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,26" id="srcline26"> 26</a></span><span class="line"><span class="comment">%        at     :: Thrust acceleration (OPTIONAL)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,27" id="srcline27"> 27</a></span><span class="line"><span class="comment">%        psi    :: flight path angle   (OPTIONAL)</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,28" id="srcline28"> 28</a></span><span class="line"><span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,29" id="srcline29"> 29</a></span><span class="line"><span class="comment">% Equations are based on Roa et al. (Nov.15) </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,30" id="srcline30"> 30</a></span><span class="line"><span class="comment">% 'Controlled generalized logarithmic spirals for low-thrust mission desing'</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,31" id="srcline31"> 31</a></span><span class="line"><span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,32" id="srcline32"> 32</a></span><span class="line"><span class="comment">% NOTE 1 ! ALL VARIBLES SHOULD NON-DIMENSIONAL GIVEN THAT mu=0</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,33" id="srcline33"> 33</a></span><span class="line"><span class="comment">% NOTE 2 ! ee = 1/2 correspond to the tangential steering case</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,34" id="srcline34"> 34</a></span><span class="line"><span class="comment">% NOTE 3 ! We consider that when phi0 = pi/2 we are in raising regime</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,35" id="srcline35"> 35</a></span><span class="line"><span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,36" id="srcline36"> 36</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,37" id="srcline37"> 37</a></span><span class="line"><span class="comment">% Check for consistent values</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,38" id="srcline38"> 38</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,39" id="srcline39"> 39</a></span><span class="line"><span class="mxinfo " id="T3:U18"><span class="var type1" id="S11T3U25">flag</span> = <span class="mxinfo " id="T3:U20">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,40" id="srcline40"> 40</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,41" id="srcline41"> 41</a></span><span class="line"><span class="comment">% Initial flight path angle</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,42" id="srcline42"> 42</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,43" id="srcline43"> 43</a></span><span class="line"><span class="mxinfo " id="T3:U21"><span class="var type1" id="S20T3U29">cpsi0</span>   = <span class="mxinfo " id="T3:U23"><span class="var type1" id="S15T3U31">regime0</span> * ( <span class="mxinfo " id="T3:U25"><span class="mxinfo " id="T3:U26">sqrt ( <span class="mxinfo " id="T3:U27"><span class="mxinfo " id="T3:U28">( <span class="mxinfo " id="T3:U29"><span class="mxinfo " id="T3:U30"><span class="mxinfo " id="T3:U31">2</span> * ( <span class="mxinfo " id="T3:U32"><span class="mxinfo " id="T3:U33">1</span> - <span class="var type1" id="S14T3U45">ee</span></span> )</span> +  <span class="mxinfo " id="T3:U35"><span class="var type1" id="S12T3U47">K1</span> * <span class="var type1" id="S16T3U48">r0</span></span></span> )^2</span> - <span class="mxinfo " id="T3:U38"><span class="var type1" id="S13T3U51">K2</span>^2</span></span> )</span> / ( <span class="mxinfo " id="T3:U40"><span class="mxinfo " id="T3:U41"><span class="mxinfo " id="T3:U42">2</span> * ( <span class="mxinfo " id="T3:U43"><span class="mxinfo " id="T3:U44">1</span> - <span class="var type1" id="S14T3U60">ee</span></span> )</span> + <span class="mxinfo " id="T3:U46"><span class="var type1" id="S12T3U62">K1</span> * <span class="var type1" id="S16T3U63">r0</span></span></span> )</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,44" id="srcline44"> 44</a></span><span class="line"><span class="mxinfo " id="T3:U49"><span class="var type1" id="S22T3U66">spsi0</span>   = <span class="mxinfo " id="T3:U51"><span class="var type1" id="S13T3U68">K2</span> / ( <span class="mxinfo " id="T3:U53"><span class="mxinfo " id="T3:U54"><span class="mxinfo " id="T3:U55">2</span> * ( <span class="mxinfo " id="T3:U56"><span class="mxinfo " id="T3:U57">1</span> - <span class="var type1" id="S14T3U76">ee</span></span> )</span> + <span class="mxinfo " id="T3:U59"><span class="var type1" id="S12T3U78">K1</span> * <span class="var type1" id="S16T3U79">r0</span></span></span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,45" id="srcline45"> 45</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,46" id="srcline46"> 46</a></span><span class="line"><span class="mxinfo " id="T3:U62"><span class="var type1" id="S23T3U82">psi0</span>    =  <span class="mxinfo " id="T3:U64">atan2( real(<span class="var type1" id="S22T3U87">spsi0</span>) , real(<span class="var type1" id="S20T3U90">cpsi0</span>) )</span></span> ;  </span></span>
<span class="srcline"><span class="lineno"><a href="1,47" id="srcline47"> 47</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,48" id="srcline48"> 48</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T4:U67"><span class="var type1" id="S11T3U94">flag</span> == <span class="mxinfo " id="T3:U69">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,49" id="srcline49"> 49</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,50" id="srcline50"> 50</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo " id="T4:U70"><span class="var type1" id="S12T3U98">K1</span>  &lt; <span class="mxinfo " id="T3:U72">-<span class="mxinfo " id="T3:U73">abs(<span class="mxinfo " id="T3:U74">eps</span>)</span></span></span> <span class="comment">% Elliptical spiral</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,51" id="srcline51"> 51</a></span><span class="line">    <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,52" id="srcline52"> 52</a></span><span class="line">    <span class="comment">% THE PARTICLE NEVER SCAPE (rmax) when propagated backward or forward</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,53" id="srcline53"> 53</a></span><span class="line">    <span class="comment">% the particle reach the origin of the central body</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,54" id="srcline54"> 54</a></span><span class="line">    <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,55" id="srcline55"> 55</a></span><span class="line">    <span class="mxinfo " id="T3:U75"><span class="var type1" id="S28T3U106">rmax</span>    = <span class="mxinfo " id="T3:U77">( <span class="mxinfo " id="T3:U78"><span class="mxinfo " id="T3:U79"><span class="mxinfo " id="T3:U80">2</span> * ( <span class="mxinfo " id="T3:U81"><span class="mxinfo " id="T3:U82">1</span>- <span class="var type1" id="S14T3U115">ee</span></span>)</span> - <span class="var type1" id="S13T3U116">K2</span></span> ) / ( <span class="mxinfo " id="T3:U85">-<span class="var type1" id="S12T3U119">K1</span></span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,56" id="srcline56"> 56</a></span><span class="line">    <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,57" id="srcline57"> 57</a></span><span class="line">    <span class="mxinfo " id="T3:U87"><span class="var type1" id="S29T3U122">ell</span>     = <span class="mxinfo " id="T3:U89">sqrt( <span class="mxinfo " id="T3:U90"><span class="mxinfo " id="T3:U91"><span class="mxinfo " id="T3:U92">4</span> * <span class="mxinfo " id="T3:U93">( <span class="mxinfo " id="T3:U94"><span class="mxinfo " id="T3:U95">1</span> - <span class="var type1" id="S14T3U132">ee</span></span> )^2</span></span> - <span class="mxinfo " id="T3:U97"><span class="var type1" id="S13T3U135">K2</span>^2</span></span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,58" id="srcline58"> 58</a></span><span class="line">    <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,59" id="srcline59"> 59</a></span><span class="line">    <span class="mxinfo " id="T3:U99"><span class="var type1" id="S30T3U139">thetam</span>  = <span class="mxinfo " id="T3:U101"><span class="var type1" id="S17T3U141">theta0</span> + <span class="mxinfo " id="T3:U103"><span class="mxinfo " id="T3:U104"><span class="mxinfo " id="T3:U105"><span class="var type1" id="S15T3U145">regime0</span> * <span class="var type1" id="S13T3U146">K2</span></span> / <span class="var type1" id="S29T3U147">ell</span></span> * <span class="mxinfo " id="T3:U109">abs( <span class="mxinfo " id="T3:U110">acosh ( <span class="mxinfo " id="T3:U111"><span class="mxinfo " id="T3:U112"><span class="var type1" id="S28T3U154">rmax</span> / <span class="var type1" id="S16T3U155">r0</span></span> - <span class="mxinfo " id="T3:U115"><span class="mxinfo " id="T3:U116"><span class="mxinfo " id="T3:U117"><span class="mxinfo " id="T3:U118">2</span> * ( <span class="mxinfo " id="T3:U119"><span class="mxinfo " id="T3:U120">1</span> - <span class="var type1" id="S14T3U163">ee</span></span>)</span> / <span class="var type1" id="S13T3U164">K2</span></span> * ( <span class="mxinfo " id="T3:U123"><span class="mxinfo " id="T3:U124">1</span> - <span class="mxinfo " id="T3:U125"><span class="var type1" id="S28T3U169">rmax</span> / <span class="var type1" id="S16T3U170">r0</span></span></span>)</span></span> )</span>)</span></span></span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,60" id="srcline60"> 60</a></span><span class="line">    <span class="mxinfo " id="T1:U128"><span class="var type1" id="S32T1U173">regime</span>  = <span class="mxinfo " id="T1:U130"><span class="mxinfo " id="T1:U131">-1 * (<span class="mxinfo " id="T5:U132"><span class="var type1" id="S19T1U180">theta</span> &gt; <span class="var type1" id="S30T3U181">thetam</span></span>)</span> + <span class="mxinfo " id="T1:U135">1 * (<span class="mxinfo " id="T5:U136"><span class="var type1" id="S19T1U186">theta</span> &lt;= <span class="var type1" id="S30T3U187">thetam</span></span>)</span></span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,61" id="srcline61"> 61</a></span><span class="line">    <span class="mxinfo " id="T1:U139"><span class="var type1" id="S33T1U190">beta</span>    = <span class="mxinfo " id="T1:U141"><span class="mxinfo " id="T3:U142"><span class="var type1" id="S29T3U193">ell</span> / <span class="var type1" id="S13T3U194">K2</span></span> * ( <span class="mxinfo " id="T1:U145"><span class="var type1" id="S19T1U197">theta</span> - <span class="var type1" id="S30T3U198">thetam</span></span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,62" id="srcline62"> 62</a></span><span class="line">    <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,63" id="srcline63"> 63</a></span><span class="line">    <span class="comment">% Trajectory</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,64" id="srcline64"> 64</a></span><span class="line">    <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,65" id="srcline65"> 65</a></span><span class="line">    <span class="mxinfo " id="T1:U148"><span class="var type1" id="S2T1U201">r</span>       = <span class="mxinfo " id="T1:U150"><span class="mxinfo " id="T3:U151"><span class="var type1" id="S28T3U204">rmax</span> * ( <span class="mxinfo " id="T3:U153"><span class="mxinfo " id="T3:U154"><span class="mxinfo " id="T3:U155">2</span> * ( <span class="mxinfo " id="T3:U156"><span class="mxinfo " id="T3:U157">1</span> - <span class="var type1" id="S14T3U212">ee</span></span>)</span> + <span class="var type1" id="S13T3U213">K2</span></span> )</span> ./ ( <span class="mxinfo " id="T1:U160"><span class="mxinfo " id="T3:U161"><span class="mxinfo " id="T3:U162">2</span> * ( <span class="mxinfo " id="T3:U163"><span class="mxinfo " id="T3:U164">1</span> - <span class="var type1" id="S14T3U221">ee</span></span> )</span> + <span class="mxinfo " id="T1:U166"><span class="var type1" id="S13T3U223">K2</span> * <span class="mxinfo " id="T1:U168">cosh ( <span class="var type1" id="S33T1U226">beta</span> )</span></span></span> )</span></span>  ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,66" id="srcline66"> 66</a></span><span class="line">    <span class="mxinfo " id="T1:U170"><span class="var type1" id="S3T1U229">v</span>       = <span class="mxinfo " id="T1:U172">sqrt ( <span class="mxinfo " id="T1:U173"><span class="var type1" id="S12T3U233">K1</span> + <span class="mxinfo " id="T1:U175"><span class="mxinfo " id="T1:U176">2 ./ <span class="var type1" id="S2T1U237">r</span></span> * ( <span class="mxinfo " id="T3:U178"><span class="mxinfo " id="T3:U179">1</span> - <span class="var type1" id="S14T3U241">ee</span></span> )</span></span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,67" id="srcline67"> 67</a></span><span class="line">    <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,68" id="srcline68"> 68</a></span><span class="line">    <span class="mxinfo " id="T1:U181"><span class="var type1" id="S35T1U244">cpsi</span>    =  <span class="mxinfo " id="T1:U183"><span class="var type1" id="S32T1U246">regime</span> .* ( <span class="mxinfo " id="T1:U185"><span class="mxinfo " id="T1:U186">sqrt ( <span class="mxinfo " id="T1:U187"><span class="mxinfo " id="T1:U188">( <span class="mxinfo " id="T1:U189"><span class="mxinfo " id="T3:U190"><span class="mxinfo " id="T3:U191">2</span> * ( <span class="mxinfo " id="T3:U192"><span class="mxinfo " id="T3:U193">1</span> - <span class="var type1" id="S14T3U260">ee</span></span> )</span> +  <span class="mxinfo " id="T1:U195"><span class="var type1" id="S12T3U262">K1</span> * <span class="var type1" id="S2T1U263">r</span></span></span> ).^2</span> - <span class="mxinfo " id="T3:U198"><span class="var type1" id="S13T3U266">K2</span>^2</span></span> )</span> ./ ( <span class="mxinfo " id="T1:U200"><span class="mxinfo " id="T3:U201"><span class="mxinfo " id="T3:U202">2</span> * ( <span class="mxinfo " id="T3:U203"><span class="mxinfo " id="T3:U204">1</span> - <span class="var type1" id="S14T3U275">ee</span></span> )</span> + <span class="mxinfo " id="T1:U206"><span class="var type1" id="S12T3U277">K1</span> * <span class="var type1" id="S2T1U278">r</span></span></span> )</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,69" id="srcline69"> 69</a></span><span class="line">    <span class="mxinfo " id="T1:U209"><span class="var type1" id="S36T1U281">spsi</span>    =  <span class="mxinfo " id="T1:U211"><span class="var type1" id="S13T3U283">K2</span> ./ ( <span class="mxinfo " id="T1:U213"><span class="mxinfo " id="T3:U214"><span class="mxinfo " id="T3:U215">2</span> * ( <span class="mxinfo " id="T3:U216"><span class="mxinfo " id="T3:U217">1</span> - <span class="var type1" id="S14T3U291">ee</span></span> )</span> + <span class="mxinfo " id="T1:U219"><span class="var type1" id="S12T3U293">K1</span> * <span class="var type1" id="S2T1U294">r</span></span></span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,70" id="srcline70"> 70</a></span><span class="line">    <span class="mxinfo " id="T1:U222"><span class="var type1" id="S9T1U297">psi</span>     =  <span class="mxinfo " id="T1:U224">atan2( <span class="var type1" id="S36T1U300">spsi</span> , <span class="var type1" id="S35T1U301">cpsi</span> )</span></span> ;  </span></span>
<span class="srcline"><span class="lineno"><a href="1,71" id="srcline71"> 71</a></span><span class="line">     </span></span>
<span class="srcline"><span class="lineno"><a href="1,72" id="srcline72"> 72</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo " id="T4:U227"><span class="var type1" id="S12T3U304">K1</span> &gt; <span class="mxinfo " id="T3:U229">abs(<span class="mxinfo " id="T3:U230">eps</span>)</span></span> <span class="comment">% Hiperbolic  Spiral</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,73" id="srcline73"> 73</a></span><span class="line">    <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,74" id="srcline74"> 74</a></span><span class="line">    <span class="comment">% THE PARTICLE REACHES INFINITY WITH A NON-ZERO VELOCITY</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,75" id="srcline75"> 75</a></span><span class="line">    <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,76" id="srcline76"> 76</a></span><span class="line">    <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,77" id="srcline77"> 77</a></span><span class="line">    <span class="keyword">if</span>  <span class="mxinfo " id="T4:U231"><span class="var type1" id="S13T3U312">K2</span> &lt; <span class="mxinfo " id="T3:U233"><span class="mxinfo " id="T3:U234">2</span> * ( <span class="mxinfo " id="T3:U235"><span class="mxinfo " id="T3:U236">1</span> - <span class="var type1" id="S14T3U318">ee</span></span> )</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,78" id="srcline78"> 78</a></span><span class="line">        <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,79" id="srcline79"> 79</a></span><span class="line">        <span class="comment">% Type I Hiperbolic Spiral ( It has an asymthotic value )</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,80" id="srcline80"> 80</a></span><span class="line">        <span class="comment">% Raising regime[ reaches infinity ], Lowering regime[ reaches origin ]</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,81" id="srcline81"> 81</a></span><span class="line">        <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,82" id="srcline82"> 82</a></span><span class="line">        <span class="mxinfo " id="T3:U238"><span class="var type1" id="S29T3U321">ell</span>     = <span class="mxinfo " id="T3:U240">sqrt( <span class="mxinfo " id="T3:U241"><span class="mxinfo " id="T3:U242"><span class="mxinfo " id="T3:U243">4</span> * <span class="mxinfo " id="T3:U244">( <span class="mxinfo " id="T3:U245"><span class="mxinfo " id="T3:U246">1</span> - <span class="var type1" id="S14T3U331">ee</span></span> )^2</span></span> - <span class="mxinfo " id="T3:U248"><span class="var type1" id="S13T3U334">K2</span>^2</span></span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,83" id="srcline83"> 83</a></span><span class="line">        <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,84" id="srcline84"> 84</a></span><span class="line">        <span class="mxinfo " id="T3:U250"><span class="var type1" id="S37T3U338">zeta</span>    = <span class="mxinfo " id="T3:U252"><span class="mxinfo " id="T3:U253"><span class="mxinfo " id="T3:U254">2</span> * ( <span class="mxinfo " id="T3:U255"><span class="mxinfo " id="T3:U256">1</span> - <span class="var type1" id="S14T3U345">ee</span></span> )</span> + <span class="var type1" id="S29T3U346">ell</span></span></span> ; </span></span>
<span class="srcline"><span class="lineno"><a href="1,85" id="srcline85"> 85</a></span><span class="line">        <span class="mxinfo " id="T3:U259"><span class="var type1" id="S38T3U349">thetaAs</span> = <span class="mxinfo " id="T3:U261"><span class="var type1" id="S17T3U351">theta0</span> + <span class="mxinfo " id="T3:U263"><span class="mxinfo " id="T3:U264"><span class="mxinfo " id="T3:U265"><span class="var type1" id="S15T3U355">regime0</span> * <span class="var type1" id="S13T3U356">K2</span></span> / <span class="var type1" id="S29T3U357">ell</span></span> * <span class="mxinfo " id="T3:U269">log( <span class="mxinfo " id="T3:U270"><span class="mxinfo " id="T3:U271"><span class="var type1" id="S13T3U362">K2</span> * ( <span class="mxinfo " id="T3:U273"><span class="mxinfo " id="T3:U274"><span class="mxinfo " id="T3:U275"><span class="var type1" id="S37T3U367">zeta</span> - <span class="var type1" id="S29T3U368">ell</span></span> - <span class="mxinfo " id="T3:U278"><span class="var type1" id="S13T3U370">K2</span> * <span class="mxinfo " id="T3:U280">sin( <span class="var type1" id="S23T3U373">psi0</span> )</span></span></span> + <span class="mxinfo " id="T3:U282"><span class="var type1" id="S29T3U375">ell</span> * <span class="mxinfo " id="T3:U284">abs( <span class="mxinfo " id="T3:U285">cos(<span class="var type1" id="S23T3U380">psi0</span>)</span> )</span></span></span> )</span> / <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,86" id="srcline86"> 86</a></span><span class="line">           ( <span class="mxinfo " id="T3:U287"><span class="mxinfo " id="T3:U288"><span class="mxinfo " id="T3:U289"><span class="var type1" id="S16T3U385">r0</span> * <span class="var type1" id="S12T3U386">K1</span></span> * <span class="var type1" id="S37T3U387">zeta</span></span> * <span class="mxinfo " id="T3:U293">sin(<span class="var type1" id="S23T3U390">psi0</span>)</span></span> )</span> )</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,87" id="srcline87"> 87</a></span><span class="line">        <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,88" id="srcline88"> 88</a></span><span class="line">        <span class="mxinfo " id="T1:U295"><span class="var type1" id="S33T1U393">beta</span>    = <span class="mxinfo " id="T1:U297"><span class="mxinfo " id="T3:U298"><span class="mxinfo " id="T3:U299"><span class="var type1" id="S15T3U397">regime0</span> * <span class="var type1" id="S29T3U398">ell</span></span> / <span class="var type1" id="S13T3U399">K2</span></span> * ( <span class="mxinfo " id="T1:U303"><span class="var type1" id="S38T3U402">thetaAs</span> - <span class="var type1" id="S19T1U403">theta</span></span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,89" id="srcline89"> 89</a></span><span class="line">        <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,90" id="srcline90"> 90</a></span><span class="line">        <span class="mxinfo " id="T1:U306"><span class="var type1" id="S2T1U406">r</span>      = <span class="mxinfo " id="T1:U308"><span class="mxinfo " id="T3:U309"><span class="var type1" id="S37T3U409">zeta</span> * <span class="mxinfo " id="T3:U311"><span class="var type1" id="S29T3U411">ell</span>^2</span></span> ./  ( <span class="mxinfo " id="T1:U313"><span class="var type1" id="S12T3U415">K1</span> * ( <span class="mxinfo " id="T1:U315"><span class="mxinfo " id="T1:U316">sinh( <span class="mxinfo " id="T1:U317"><span class="var type1" id="S33T1U421">beta</span> / 2</span>)</span> .* ( <span class="mxinfo " id="T1:U319"><span class="mxinfo " id="T1:U320"><span class="mxinfo " id="T3:U321"><span class="mxinfo " id="T3:U322"><span class="mxinfo " id="T3:U323">4</span> * <span class="var type1" id="S37T3U429">zeta</span></span> * ( <span class="mxinfo " id="T3:U325"><span class="mxinfo " id="T3:U326">1</span> - <span class="var type1" id="S14T3U433">ee</span></span> )</span> * <span class="mxinfo " id="T1:U328">sinh( <span class="mxinfo " id="T1:U329"><span class="var type1" id="S33T1U437">beta</span> / 2</span> )</span></span> + <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,91" id="srcline91"> 91</a></span><span class="line">            <span class="mxinfo " id="T1:U331">( <span class="mxinfo " id="T3:U332"><span class="mxinfo " id="T3:U333"><span class="var type1" id="S37T3U443">zeta</span>^2</span> - <span class="mxinfo " id="T3:U335"><span class="var type1" id="S13T3U446">K2</span>^2</span></span> ) * <span class="mxinfo " id="T1:U337">cosh( <span class="mxinfo " id="T1:U338"><span class="var type1" id="S33T1U451">beta</span> / 2</span> )</span></span></span> )</span> )</span> )</span></span>  ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,92" id="srcline92"> 92</a></span><span class="line">        <span class="mxinfo " id="T1:U340"><span class="var type1" id="S3T1U455">v</span>      = <span class="mxinfo " id="T1:U342">sqrt ( <span class="mxinfo " id="T1:U343"><span class="var type1" id="S12T3U459">K1</span> + <span class="mxinfo " id="T1:U345"><span class="mxinfo " id="T1:U346">2 ./ <span class="var type1" id="S2T1U463">r</span></span> * ( <span class="mxinfo " id="T3:U348"><span class="mxinfo " id="T3:U349">1</span> - <span class="var type1" id="S14T3U467">ee</span></span> )</span></span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,93" id="srcline93"> 93</a></span><span class="line">        <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,94" id="srcline94"> 94</a></span><span class="line">        <span class="mxinfo " id="T1:U351"><span class="var type1" id="S35T1U470">cpsi</span>   = <span class="mxinfo " id="T1:U353"><span class="var type1" id="S15T3U472">regime0</span> * ( <span class="mxinfo " id="T1:U355"><span class="mxinfo " id="T1:U356">sqrt ( <span class="mxinfo " id="T1:U357"><span class="mxinfo " id="T1:U358">( <span class="mxinfo " id="T1:U359"><span class="mxinfo " id="T3:U360"><span class="mxinfo " id="T3:U361">2</span> * ( <span class="mxinfo " id="T3:U362"><span class="mxinfo " id="T3:U363">1</span> - <span class="var type1" id="S14T3U486">ee</span></span> )</span> +  <span class="mxinfo " id="T1:U365"><span class="var type1" id="S12T3U488">K1</span> * <span class="var type1" id="S2T1U489">r</span></span></span> ).^2</span> - <span class="mxinfo " id="T3:U368"><span class="var type1" id="S13T3U492">K2</span>^2</span></span> )</span> ./ ( <span class="mxinfo " id="T1:U370"><span class="mxinfo " id="T3:U371"><span class="mxinfo " id="T3:U372">2</span> * ( <span class="mxinfo " id="T3:U373"><span class="mxinfo " id="T3:U374">1</span> - <span class="var type1" id="S14T3U501">ee</span></span> )</span> + <span class="mxinfo " id="T1:U376"><span class="var type1" id="S12T3U503">K1</span> * <span class="var type1" id="S2T1U504">r</span></span></span> )</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,95" id="srcline95"> 95</a></span><span class="line">        <span class="mxinfo " id="T1:U379"><span class="var type1" id="S36T1U507">spsi</span>   = <span class="mxinfo " id="T1:U381"><span class="var type1" id="S13T3U509">K2</span> ./ ( <span class="mxinfo " id="T1:U383"><span class="mxinfo " id="T3:U384"><span class="mxinfo " id="T3:U385">2</span> * ( <span class="mxinfo " id="T3:U386"><span class="mxinfo " id="T3:U387">1</span> - <span class="var type1" id="S14T3U517">ee</span></span> )</span> + <span class="mxinfo " id="T1:U389"><span class="var type1" id="S12T3U519">K1</span> * <span class="var type1" id="S2T1U520">r</span></span></span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,96" id="srcline96"> 96</a></span><span class="line">        <span class="comment">%  </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,97" id="srcline97"> 97</a></span><span class="line">        <span class="mxinfo " id="T1:U392"><span class="var type1" id="S9T1U523">psi</span>    =  <span class="mxinfo " id="T1:U394">atan2(<span class="var type1" id="S36T1U526">spsi</span> , <span class="var type1" id="S35T1U527">cpsi</span> )</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,98" id="srcline98"> 98</a></span><span class="line"> </span></span>
<span class="srcline"><span class="lineno"><a href="1,99" id="srcline99"> 99</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="1,100" id="srcline100">100</a></span><span class="line">    <span class="keyword">elseif</span>  <span class="mxinfo " id="T4:U397"><span class="var type1" id="S13T3U530">K2</span> &gt; <span class="mxinfo " id="T3:U399"><span class="mxinfo " id="T3:U400">2</span> * ( <span class="mxinfo " id="T3:U401"><span class="mxinfo " id="T3:U402">1</span> - <span class="var type1" id="S14T3U536">ee</span></span> )</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,101" id="srcline101">101</a></span><span class="line">        <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,102" id="srcline102">102</a></span><span class="line">        <span class="comment">% Type II Hiperbolic Spiral</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,103" id="srcline103">103</a></span><span class="line">        <span class="comment">% There is a transition between raising and lowering regime [rmin]  </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,104" id="srcline104">104</a></span><span class="line">        <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,105" id="srcline105">105</a></span><span class="line">        <span class="mxinfo " id="T3:U404"><span class="var type1" id="S43T3U539">rmin</span> = <span class="mxinfo " id="T3:U406">( <span class="mxinfo " id="T3:U407"><span class="var type1" id="S13T3U543">K2</span> - <span class="mxinfo " id="T3:U409"><span class="mxinfo " id="T3:U410">2</span> * ( <span class="mxinfo " id="T3:U411"><span class="mxinfo " id="T3:U412">1</span> - <span class="var type1" id="S14T3U549">ee</span></span> )</span></span> ) / ( <span class="var type1" id="S12T3U551">K1</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,106" id="srcline106">106</a></span><span class="line">        <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,107" id="srcline107">107</a></span><span class="line">        <span class="mxinfo " id="T3:U415"><span class="var type1" id="S29T3U554">ell</span>  = <span class="mxinfo " id="T3:U417">sqrt ( <span class="mxinfo " id="T3:U418"><span class="mxinfo " id="T3:U419"><span class="var type1" id="S13T3U559">K2</span>^2</span> - <span class="mxinfo " id="T3:U421"><span class="mxinfo " id="T3:U422">4</span> * <span class="mxinfo " id="T3:U423">( <span class="mxinfo " id="T3:U424"><span class="mxinfo " id="T3:U425">1</span> - <span class="var type1" id="S14T3U567">ee</span></span> )^2</span></span></span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,108" id="srcline108">108</a></span><span class="line">        <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,109" id="srcline109">109</a></span><span class="line">        <span class="mxinfo " id="T3:U427"><span class="var type1" id="S30T3U571">thetam</span>   = <span class="mxinfo " id="T3:U429"><span class="var type1" id="S17T3U573">theta0</span> - <span class="mxinfo " id="T3:U431"><span class="mxinfo " id="T3:U432"><span class="mxinfo " id="T3:U433"><span class="var type1" id="S15T3U577">regime0</span> * <span class="var type1" id="S13T3U578">K2</span></span> / <span class="var type1" id="S29T3U579">ell</span></span> * ( <span class="mxinfo " id="T3:U437"><span class="mxinfo " id="T3:U438"><span class="mxinfo " id="T3:U439">pi</span> / <span class="mxinfo " id="T3:U440">2</span></span> + <span class="mxinfo " id="T3:U441">atan ( <span class="mxinfo " id="T3:U442">( <span class="mxinfo " id="T3:U443"><span class="mxinfo " id="T3:U444"><span class="mxinfo " id="T3:U445">2</span> * ( <span class="mxinfo " id="T3:U446"><span class="mxinfo " id="T3:U447">1</span> - <span class="var type1" id="S14T3U596">ee</span></span> )</span> - <span class="mxinfo " id="T3:U449"><span class="var type1" id="S13T3U598">K2</span> * <span class="mxinfo " id="T3:U451">sin(<span class="var type1" id="S23T3U601">psi0</span>)</span></span></span> ) / <span class="keyword">...</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,110" id="srcline110">110</a></span><span class="line">            (<span class="mxinfo " id="T3:U453"><span class="var type1" id="S29T3U604">ell</span> * <span class="mxinfo " id="T3:U455">abs ( <span class="mxinfo " id="T3:U456">cos(<span class="var type1" id="S23T3U609">psi0</span>)</span> )</span></span> )</span> )</span></span> )</span></span></span>; </span></span>
<span class="srcline"><span class="lineno"><a href="1,111" id="srcline111">111</a></span><span class="line">        <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,112" id="srcline112">112</a></span><span class="line">        <span class="mxinfo " id="T1:U458"><span class="var type1" id="S33T1U612">beta</span> = <span class="mxinfo " id="T1:U460"><span class="mxinfo " id="T3:U461"><span class="var type1" id="S29T3U615">ell</span> / <span class="var type1" id="S13T3U616">K2</span></span> * ( <span class="mxinfo " id="T1:U464"><span class="var type1" id="S19T1U619">theta</span> - <span class="var type1" id="S30T3U620">thetam</span></span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,113" id="srcline113">113</a></span><span class="line">        <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,114" id="srcline114">114</a></span><span class="line">        <span class="mxinfo " id="T1:U467"><span class="var type1" id="S2T1U623">r</span>   = <span class="mxinfo " id="T1:U469"><span class="var type1" id="S43T3U625">rmin</span> * ( <span class="mxinfo " id="T1:U471">( <span class="mxinfo " id="T3:U472"><span class="mxinfo " id="T3:U473"><span class="mxinfo " id="T3:U474">2</span> * ( <span class="mxinfo " id="T3:U475"><span class="mxinfo " id="T3:U476">1</span> - <span class="var type1" id="S14T3U635">ee</span></span> )</span> + <span class="var type1" id="S13T3U636">K2</span></span> ) ./ ( <span class="mxinfo " id="T1:U479"><span class="mxinfo " id="T3:U480"><span class="mxinfo " id="T3:U481">2</span> * ( <span class="mxinfo " id="T3:U482"><span class="mxinfo " id="T3:U483">1</span> - <span class="var type1" id="S14T3U644">ee</span></span> )</span> + <span class="mxinfo " id="T1:U485"><span class="var type1" id="S13T3U646">K2</span> * <span class="mxinfo " id="T1:U487">cos(<span class="var type1" id="S33T1U649">beta</span>)</span></span></span> )</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,115" id="srcline115">115</a></span><span class="line">        <span class="mxinfo " id="T1:U489"><span class="var type1" id="S3T1U652">v</span>   = <span class="mxinfo " id="T1:U491">sqrt ( <span class="mxinfo " id="T1:U492"><span class="var type1" id="S12T3U656">K1</span> + <span class="mxinfo " id="T1:U494"><span class="mxinfo " id="T1:U495">2 ./ <span class="var type1" id="S2T1U660">r</span></span> * ( <span class="mxinfo " id="T3:U497"><span class="mxinfo " id="T3:U498">1</span> - <span class="var type1" id="S14T3U664">ee</span></span> )</span></span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,116" id="srcline116">116</a></span><span class="line">        <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,117" id="srcline117">117</a></span><span class="line">        <span class="mxinfo " id="T1:U500"><span class="var type1" id="S32T1U667">regime</span>  = <span class="mxinfo " id="T1:U502"><span class="mxinfo " id="T1:U503">-1 * (<span class="mxinfo " id="T5:U504"><span class="var type1" id="S19T1U674">theta</span> &lt; <span class="var type1" id="S30T3U675">thetam</span></span>)</span> + <span class="mxinfo " id="T1:U507">1 * (<span class="mxinfo " id="T5:U508"><span class="var type1" id="S19T1U680">theta</span> &gt;= <span class="var type1" id="S30T3U681">thetam</span></span>)</span></span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,118" id="srcline118">118</a></span><span class="line">        <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,119" id="srcline119">119</a></span><span class="line">        <span class="mxinfo " id="T1:U511"><span class="var type1" id="S35T1U684">cpsi</span>   = <span class="mxinfo " id="T1:U513"><span class="var type1" id="S32T1U686">regime</span> .* ( <span class="mxinfo " id="T1:U515"><span class="mxinfo " id="T1:U516">sqrt ( <span class="mxinfo " id="T1:U517"><span class="mxinfo " id="T1:U518">( <span class="mxinfo " id="T1:U519"><span class="mxinfo " id="T3:U520"><span class="mxinfo " id="T3:U521">2</span> * ( <span class="mxinfo " id="T3:U522"><span class="mxinfo " id="T3:U523">1</span> - <span class="var type1" id="S14T3U700">ee</span></span> )</span> +  <span class="mxinfo " id="T1:U525"><span class="var type1" id="S12T3U702">K1</span> * <span class="var type1" id="S2T1U703">r</span></span></span> ).^2</span> - <span class="mxinfo " id="T3:U528"><span class="var type1" id="S13T3U706">K2</span>^2</span></span> )</span> ./ ( <span class="mxinfo " id="T1:U530"><span class="mxinfo " id="T3:U531"><span class="mxinfo " id="T3:U532">2</span> * ( <span class="mxinfo " id="T3:U533"><span class="mxinfo " id="T3:U534">1</span> - <span class="var type1" id="S14T3U715">ee</span></span> )</span> + <span class="mxinfo " id="T1:U536"><span class="var type1" id="S12T3U717">K1</span> * <span class="var type1" id="S2T1U718">r</span></span></span> )</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,120" id="srcline120">120</a></span><span class="line">        <span class="mxinfo " id="T1:U539"><span class="var type1" id="S36T1U721">spsi</span>   = <span class="mxinfo " id="T1:U541"><span class="var type1" id="S13T3U723">K2</span> ./ ( <span class="mxinfo " id="T1:U543"><span class="mxinfo " id="T3:U544"><span class="mxinfo " id="T3:U545">2</span> * ( <span class="mxinfo " id="T3:U546"><span class="mxinfo " id="T3:U547">1</span> - <span class="var type1" id="S14T3U731">ee</span></span> )</span> + <span class="mxinfo " id="T1:U549"><span class="var type1" id="S12T3U733">K1</span> * <span class="var type1" id="S2T1U734">r</span></span></span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,121" id="srcline121">121</a></span><span class="line">        <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,122" id="srcline122">122</a></span><span class="line">        <span class="mxinfo " id="T1:U552"><span class="var type1" id="S9T1U737">psi</span>    =  <span class="mxinfo " id="T1:U554">atan2( <span class="var type1" id="S36T1U740">spsi</span> , <span class="var type1" id="S35T1U741">cpsi</span> )</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,123" id="srcline123">123</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,124" id="srcline124">124</a></span><span class="line">    <span class="keyword">else</span> </span></span>
<span class="srcline"><span class="lineno"><a href="1,125" id="srcline125">125</a></span><span class="line">        <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,126" id="srcline126">126</a></span><span class="line">        <span class="comment">% Limit case Hiperbolyc spiral</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,127" id="srcline127">127</a></span><span class="line">        <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,128" id="srcline128">128</a></span><span class="line">        <span class="mxinfo " id="T3:U557"><span class="var type1" id="S38T3U745">thetaAs</span>  = <span class="mxinfo " id="T3:U559"><span class="var type1" id="S17T3U747">theta0</span> - <span class="mxinfo " id="T3:U561"><span class="var type1" id="S15T3U749">regime0</span> * ( <span class="mxinfo " id="T3:U563"><span class="mxinfo " id="T3:U564">1</span> - <span class="mxinfo " id="T3:U565">sqrt( <span class="mxinfo " id="T3:U566"><span class="mxinfo " id="T3:U567">1</span> + <span class="mxinfo " id="T3:U568"><span class="mxinfo " id="T3:U569"><span class="mxinfo " id="T3:U570">4</span> * ( <span class="mxinfo " id="T3:U571"><span class="mxinfo " id="T3:U572">1</span> - <span class="var type1" id="S14T3U763">ee</span></span> )</span> / ( <span class="mxinfo " id="T3:U574"><span class="var type1" id="S12T3U766">K1</span> * <span class="var type1" id="S16T3U767">r0</span></span> )</span></span> )</span></span> )</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,129" id="srcline129">129</a></span><span class="line">        <span class="mxinfo " id="T1:U577"><span class="var type1" id="S33T1U770">beta</span>     = <span class="mxinfo " id="T1:U579"><span class="var type1" id="S19T1U772">theta</span> - <span class="var type1" id="S38T3U773">thetaAs</span></span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,130" id="srcline130">130</a></span><span class="line">        <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,131" id="srcline131">131</a></span><span class="line">        <span class="mxinfo " id="T1:U582"><span class="var type1" id="S2T1U776">r</span>       = <span class="mxinfo " id="T1:U584"><span class="mxinfo " id="T3:U585"><span class="mxinfo " id="T3:U586">4</span> * ( <span class="mxinfo " id="T3:U587"><span class="mxinfo " id="T3:U588">1</span> - <span class="var type1" id="S14T3U783">ee</span></span> )</span>./ ( <span class="mxinfo " id="T1:U590"><span class="mxinfo " id="T1:U591"><span class="var type1" id="S12T3U787">K1</span> * <span class="var type1" id="S33T1U788">beta</span></span> .* ( <span class="mxinfo " id="T1:U594"><span class="var type1" id="S33T1U791">beta</span> - <span class="mxinfo " id="T3:U596"><span class="var type1" id="S15T3U793">regime0</span> * <span class="mxinfo " id="T3:U598">2</span></span></span> )</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,132" id="srcline132">132</a></span><span class="line">        <span class="mxinfo " id="T1:U599"><span class="var type1" id="S3T1U797">v</span>       = <span class="mxinfo " id="T1:U601">sqrt ( <span class="mxinfo " id="T1:U602"><span class="var type1" id="S12T3U801">K1</span> + <span class="mxinfo " id="T1:U604"><span class="mxinfo " id="T1:U605">2 ./ <span class="var type1" id="S2T1U805">r</span></span> * ( <span class="mxinfo " id="T3:U607"><span class="mxinfo " id="T3:U608">1</span> - <span class="var type1" id="S14T3U809">ee</span></span> )</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,133" id="srcline133">133</a></span><span class="line">        <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,134" id="srcline134">134</a></span><span class="line">        <span class="mxinfo " id="T1:U610"><span class="var type1" id="S35T1U812">cpsi</span>   = <span class="mxinfo " id="T1:U612"><span class="var type1" id="S15T3U814">regime0</span> .* ( <span class="mxinfo " id="T1:U614"><span class="mxinfo " id="T1:U615">sqrt ( <span class="mxinfo " id="T1:U616"><span class="mxinfo " id="T1:U617">( <span class="mxinfo " id="T1:U618"><span class="mxinfo " id="T3:U619"><span class="mxinfo " id="T3:U620">2</span> * ( <span class="mxinfo " id="T3:U621"><span class="mxinfo " id="T3:U622">1</span> - <span class="var type1" id="S14T3U828">ee</span></span> )</span> +  <span class="mxinfo " id="T1:U624"><span class="var type1" id="S12T3U830">K1</span> * <span class="var type1" id="S2T1U831">r</span></span></span> ).^2</span> - <span class="mxinfo " id="T3:U627"><span class="var type1" id="S13T3U834">K2</span>^2</span></span> )</span> ./ ( <span class="mxinfo " id="T1:U629"><span class="mxinfo " id="T3:U630"><span class="mxinfo " id="T3:U631">2</span> * ( <span class="mxinfo " id="T3:U632"><span class="mxinfo " id="T3:U633">1</span> - <span class="var type1" id="S14T3U843">ee</span></span> )</span> + <span class="mxinfo " id="T1:U635"><span class="var type1" id="S12T3U845">K1</span> * <span class="var type1" id="S2T1U846">r</span></span></span> )</span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,135" id="srcline135">135</a></span><span class="line">        <span class="mxinfo " id="T1:U638"><span class="var type1" id="S36T1U849">spsi</span>   = <span class="mxinfo " id="T1:U640"><span class="var type1" id="S13T3U851">K2</span> ./ ( <span class="mxinfo " id="T1:U642"><span class="mxinfo " id="T3:U643"><span class="mxinfo " id="T3:U644">2</span> * ( <span class="mxinfo " id="T3:U645"><span class="mxinfo " id="T3:U646">1</span> - <span class="var type1" id="S14T3U859">ee</span></span> )</span> + <span class="mxinfo " id="T1:U648"><span class="var type1" id="S12T3U861">K1</span> * <span class="var type1" id="S2T1U862">r</span></span></span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,136" id="srcline136">136</a></span><span class="line">        <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,137" id="srcline137">137</a></span><span class="line">        <span class="mxinfo " id="T1:U651"><span class="var type1" id="S9T1U865">psi</span>    =  <span class="mxinfo " id="T1:U653">atan2( <span class="var type1" id="S36T1U868">spsi</span> , <span class="var type1" id="S35T1U869">cpsi</span> )</span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,138" id="srcline138">138</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,139" id="srcline139">139</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,140" id="srcline140">140</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,141" id="srcline141">141</a></span><span class="line"><span class="keyword">elseif</span> <span class="mxinfo " id="T4:U656"><span class="mxinfo " id="T3:U657">abs(<span class="var type1" id="S12T3U874">K1</span>)</span>&lt; <span class="mxinfo " id="T3:U659">abs(<span class="mxinfo " id="T3:U660">eps</span>)</span></span>; <span class="comment">% Parabolic spiral</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,142" id="srcline142">142</a></span><span class="line">    <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,143" id="srcline143">143</a></span><span class="line">    <span class="comment">% THE FLIGHT PATH ANGLE REMAINS CONSTANT</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,144" id="srcline144">144</a></span><span class="line">    <span class="comment">% THE PARTICLE REACHES INFINITY WITH A ZERO VELOCITY</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,145" id="srcline145">145</a></span><span class="line">    <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,146" id="srcline146">146</a></span><span class="line">    <span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,147" id="srcline147">147</a></span><span class="line">    <span class="mxinfo " id="T3:U661"><span class="var type1" id="S29T3U881">ell</span>     = <span class="mxinfo " id="T3:U663">sqrt( <span class="mxinfo " id="T3:U664"><span class="mxinfo " id="T3:U665"><span class="mxinfo " id="T3:U666">4</span> * <span class="mxinfo " id="T3:U667">( <span class="mxinfo " id="T3:U668"><span class="mxinfo " id="T3:U669">1</span> - <span class="var type1" id="S14T3U891">ee</span></span> )^2</span></span> - <span class="mxinfo " id="T3:U671"><span class="var type1" id="S13T3U894">K2</span>^2</span></span> )</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,148" id="srcline148">148</a></span><span class="line">    <span class="comment">%    </span></span></span>
<span class="srcline"><span class="lineno"><a href="1,149" id="srcline149">149</a></span><span class="line">    <span class="mxinfo " id="T1:U673"><span class="var type1" id="S2T1U898">r</span>       = <span class="mxinfo " id="T1:U675"><span class="var type1" id="S16T3U900">r0</span> * <span class="mxinfo " id="T1:U677">exp( <span class="mxinfo " id="T1:U678"><span class="mxinfo " id="T1:U679"><span class="mxinfo " id="T3:U680"><span class="var type1" id="S15T3U906">regime0</span> * <span class="var type1" id="S29T3U907">ell</span></span> * ( <span class="mxinfo " id="T1:U683"><span class="var type1" id="S19T1U910">theta</span> - <span class="var type1" id="S17T3U911">theta0</span></span> )</span> / <span class="var type1" id="S13T3U912">K2</span></span> )</span></span></span> ;</span></span>
<span class="srcline"><span class="lineno"><a href="1,150" id="srcline150">150</a></span><span class="line">    <span class="mxinfo " id="T1:U687"><span class="var type1" id="S3T1U915">v</span>       = <span class="mxinfo " id="T1:U689">sqrt ( <span class="mxinfo " id="T1:U690"><span class="var type1" id="S12T3U919">K1</span> + <span class="mxinfo " id="T1:U692"><span class="mxinfo " id="T1:U693">2 ./ <span class="var type1" id="S2T1U923">r</span></span> * ( <span class="mxinfo " id="T3:U695"><span class="mxinfo " id="T3:U696">1</span> - <span class="var type1" id="S14T3U927">ee</span></span> )</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,151" id="srcline151">151</a></span><span class="line">    <span class="mxinfo " id="T1:U698"><span class="var type1" id="S9T1U930">psi</span>     = <span class="mxinfo " id="T1:U700"><span class="var type1" id="S23T3U932">psi0</span>*<span class="mxinfo " id="T1:U702">ones(<span class="mxinfo " id="T6:U703">size(<span class="var type1" id="S2T1U937">r</span>)</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,152" id="srcline152">152</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,153" id="srcline153">153</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,154" id="srcline154">154</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,155" id="srcline155">155</a></span><span class="line"><span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,156" id="srcline156">156</a></span><span class="line"><span class="comment">% Obtain the corresponding orbital elements if desired</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,157" id="srcline157">157</a></span><span class="line"><span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,158" id="srcline158">158</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,159" id="srcline159">159</a></span><span class="line"><span class="mxinfo " id="T1:U705"><span class="var type1" id="S6T1U940">e</span>  = <span class="mxinfo " id="T1:U707">sqrt(<span class="mxinfo " id="T1:U708"><span class="mxinfo " id="T3:U709"><span class="mxinfo " id="T3:U710"><span class="var type1" id="S13T3U946">K2</span>^2</span>+<span class="mxinfo " id="T3:U712">1</span></span> - <span class="mxinfo " id="T1:U713"><span class="mxinfo " id="T3:U714"><span class="mxinfo " id="T3:U715">2</span>*<span class="var type1" id="S13T3U952">K2</span></span>*<span class="mxinfo " id="T1:U717">sin(<span class="var type1" id="S9T1U955">psi</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,160" id="srcline160">160</a></span><span class="line"><span class="mxinfo " id="T1:U719"><span class="var type1" id="S5T1U958">a</span>  = (<span class="mxinfo " id="T1:U721"><span class="var type1" id="S2T1U961">r</span>./(<span class="mxinfo " id="T1:U723"><span class="mxinfo " id="T3:U724"><span class="mxinfo " id="T3:U725">2</span>*<span class="var type1" id="S14T3U966">ee</span></span>-<span class="mxinfo " id="T1:U727"><span class="var type1" id="S12T3U968">K1</span>*<span class="var type1" id="S2T1U969">r</span></span></span>)</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,161" id="srcline161">161</a></span><span class="line"><span class="mxinfo " id="T1:U730"><span class="var type1" id="S7T1U972">w</span>  = <span class="mxinfo " id="T1:U732"><span class="mxinfo " id="T1:U733">atan2( <span class="mxinfo " id="T1:U734"><span class="mxinfo " id="T1:U735">sin(<span class="var type1" id="S19T1U979">theta</span>)</span> + <span class="mxinfo " id="T1:U737"><span class="var type1" id="S13T3U981">K2</span> * <span class="mxinfo " id="T1:U739">cos( <span class="mxinfo " id="T1:U740"><span class="var type1" id="S19T1U985">theta</span> + <span class="var type1" id="S9T1U986">psi</span></span> )</span></span></span>, <span class="mxinfo " id="T1:U743"><span class="mxinfo " id="T1:U744">cos(<span class="var type1" id="S19T1U990">theta</span>)</span> - <span class="mxinfo " id="T1:U746"><span class="var type1" id="S13T3U992">K2</span> * <span class="mxinfo " id="T1:U748">sin(<span class="mxinfo " id="T1:U749"><span class="var type1" id="S19T1U996">theta</span> + <span class="var type1" id="S9T1U997">psi</span></span>)</span></span></span> )</span> + <span class="mxinfo " id="T3:U752">pi</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,162" id="srcline162">162</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,163" id="srcline163">163</a></span><span class="line"><span class="comment">% Obtain the corresponding DV</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,164" id="srcline164">164</a></span><span class="line"><span class="comment">%</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,165" id="srcline165">165</a></span><span class="line"><span class="keyword">if</span> (<span class="mxinfo " id="T4:U753"><span class="mxinfo " id="T3:U754">abs(<span class="mxinfo " id="T3:U755"><span class="mxinfo " id="T3:U756"><span class="var type1" id="S19T1U1008">theta</span>(<span class="mxinfo " id="T7:U758">end</span>)</span>-<span class="mxinfo " id="T3:U759"><span class="var type1" id="S19T1U1012">theta</span>(<span class="mxinfo " id="T3:U761">1</span>)</span></span>)</span> &lt; <span class="mxinfo " id="T3:U762">1e-12</span></span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,166" id="srcline166">166</a></span><span class="line">    <span class="comment">% Avoid errors with zero arcs duration</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,167" id="srcline167">167</a></span><span class="line">    <span class="mxinfo " id="T2:U763"><span class="var type1" id="S8T2U1017">at</span>    = <span class="mxinfo " id="T3:U765">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,168" id="srcline168">168</a></span><span class="line">    <span class="mxinfo " id="T3:U766"><span class="var type1" id="S10T3U1021">DV</span>    = <span class="mxinfo " id="T3:U768">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,169" id="srcline169">169</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,170" id="srcline170">170</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,171" id="srcline171">171</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,172" id="srcline172">172</a></span><span class="line"><span class="mxinfo " id="T2:U769"><span class="var type1" id="S8T2U1026">at</span>        = <span class="mxinfo " id="T1:U771"><span class="mxinfo " id="T1:U772">1 ./ <span class="mxinfo " id="T1:U773"><span class="var type1" id="S2T1U1031">r</span>.^2</span></span> .* <span class="mxinfo " id="T1:U775">sqrt( <span class="mxinfo " id="T1:U776"><span class="mxinfo " id="T1:U777"><span class="mxinfo " id="T3:U778"><span class="var type1" id="S14T3U1038">ee</span>^2</span> * <span class="mxinfo " id="T1:U780"><span class="mxinfo " id="T1:U781">cos(<span class="var type1" id="S9T1U1043">psi</span>)</span>.^2</span></span> + <span class="mxinfo " id="T1:U783"><span class="mxinfo " id="T3:U784">( <span class="mxinfo " id="T3:U785"><span class="mxinfo " id="T3:U786">1</span> - <span class="mxinfo " id="T3:U787"><span class="mxinfo " id="T3:U788">2</span> * <span class="var type1" id="S14T3U1052">ee</span></span></span> )^2</span> * <span class="mxinfo " id="T1:U790"><span class="mxinfo " id="T1:U791">sin(<span class="var type1" id="S9T1U1057">psi</span>)</span>.^2</span></span></span> )</span></span></span>;    </span></span>
<span class="srcline"><span class="lineno"><a href="1,173" id="srcline173">173</a></span><span class="line"><span class="mxinfo " id="T8:U793"><span class="var type1" id="S50T8U1061">integran</span>  = <span class="mxinfo " id="T8:U795">@(thetai,theta,at,v,psi,r) interp1(theta,at.*1./(v.*cos(psi)).*r./tan(psi),thetai,<span class="string">'linear'</span>,<span class="string">'extrap'</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,174" id="srcline174">174</a></span><span class="line"><span class="var type0" id="S10T0U1093">DV</span>        = <span class="message error" id="M1F1C">integral(<span class="mxinfo " id="T9:U796">@(thetai)<span class="var type0" id="S50T0U1099">integran</span>(thetai,<span class="var type0" id="S19T0U1101">theta</span>,<span class="var type0" id="S8T0U1102">at</span>,<span class="var type0" id="S3T0U1103">v</span>,<span class="var type0" id="S9T0U1104">psi</span>,<span class="var type0" id="S2T0U1105">r</span>)</span>,<span class="mxinfo " id="T3:U797"><span class="var type1" id="S19T1U1107">theta</span>(<span class="mxinfo " id="T3:U799">1</span>)</span>,<span class="mxinfo " id="T3:U800"><span class="var type1" id="S19T1U1110">theta</span>(<span class="mxinfo " id="T3:U802">end</span>)</span>)</span>; </span></span>
<span class="srcline"><span class="lineno"><a href="1,175" id="srcline175">175</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo " id="T4:U803"><span class="var type1" id="S10T3U1116">DV</span> == <span class="mxinfo " id="T3:U805">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,176" id="srcline176">176</a></span><span class="line">    <span class="mxinfo " id="T3:U806"><span class="var type1" id="S11T3U1120">flag</span> = <span class="mxinfo " id="T3:U808">-<span class="mxinfo " id="T3:U809">1</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,177" id="srcline177">177</a></span><span class="line">   </span></span>
<span class="srcline"><span class="lineno"><a href="1,178" id="srcline178">178</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,179" id="srcline179">179</a></span><span class="line"><span class="keyword"><span class="keyword">end</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,180" id="srcline180">180</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,181" id="srcline181">181</a></span><span class="line"><span class="comment">%t         = NaN;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,182" id="srcline182">182</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="1,183" id="srcline183">183</a></span><span class="line"></span></span>
</pre>
</body>
</html>
